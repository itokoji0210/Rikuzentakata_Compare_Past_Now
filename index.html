<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>YouTube æ¯”è¼ƒï¼ˆãƒ•ã‚§ãƒ¼ãƒ‰ï¼‹ã‚µãƒ–ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼åŒæœŸãƒ»ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰</title>
<style>
  :root{
    --split:50%;
    --fade:1;                 /* 1=ä»Šï¼ˆä¸Š100%ï¼‰ / 0=éå»ï¼ˆä¸Š0%ï¼‰ */
    --accent:#2b7cff;
    --radius:12px;
    --timeline:#2b7cff;       /* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³(é’) */
    --timeline-bg:#1b1f2a;    /* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³èƒŒæ™¯ */
    --timeline-border:#2a3142;
    --compare-bg:#2a2f3d;     /* æ¯”è¼ƒã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼(ç°) */
  }
  body{margin:0;background:#0f1115;color:#e8e8e8;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Sans","Noto Sans JP",sans-serif}
  header{padding:14px 16px 6px}
  h1{font-size:clamp(16px,2.6vw,20px);margin:0 0 6px}
  p{margin:0;font-size:12px;opacity:.85}
  .wrap{max-width:1200px;margin:10px auto 18px;padding:0 12px}

  .compare{position:relative;width:100%;aspect-ratio:16/9;background:#000;border-radius:var(--radius);overflow:hidden}
  .layer{position:absolute;inset:0}
  .ytbox{position:absolute;inset:0}
  /* ä¸Šãƒ¬ã‚¤ãƒ¤ï¼ˆä»Šï¼‰ã‚’ãƒ•ã‚§ãƒ¼ãƒ‰ or ã‚¹ãƒ©ã‚¤ã‚¹ */
  .mode-fade   .top{opacity:var(--fade);transition:opacity .06s linear;clip-path:inset(0 0 0 0)}
  .mode-slider .top{opacity:1;clip-path:inset(0 calc(100% - var(--split)) 0 0)} /* ã‚µãƒ–ï¼ˆä¸­å¤®ãƒãƒ¼ï¼‰ */

  /* ãƒ©ãƒ™ãƒ«å¸¯ï¼‹ãƒ•ã‚§ãƒ¼ãƒ‰ç”¨ãƒŸãƒ‹ãƒ•ã‚§ãƒ¼ãƒ€ãƒ¼ */
  .topband{position:absolute;left:0;right:0;top:0;z-index:5;display:flex;justify-content:space-between;align-items:center;gap:8px;padding:8px 12px;background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.05))}
  .tag{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,.4)}
  .dot{width:8px;height:8px;border-radius:50%;background:#fff;opacity:.9}
  .past .dot{background:#9ec1ff}.now .dot{background:#9dffb0}
  .sub{opacity:.9}
  .mode-badge{padding:6px 10px;border-radius:999px;background:#1b1f2a;border:1px solid #2a3142;font-size:12px}
  .fade-mini{display:flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:#1b1f2a;border:1px solid #2a3142}
  .fade-mini input{width:140px;height:6px}

  /* ã‚µãƒ–ï¼šä¸­å¤®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼UIï¼ˆãƒ¢ãƒ¼ãƒ‰=sliderã®ã¨ãã ã‘å‡ºã™ï¼‰ */
  .slider-rail{position:absolute;inset:0;pointer-events:none;z-index:4}
  .split-line{position:absolute;top:0;bottom:0;left:var(--split);transform:translateX(-50%);width:2px;background:rgba(255,255,255,.92)}
  .handle{position:absolute;top:50%;left:var(--split);transform:translate(-50%,-50%);width:24px;height:24px;border-radius:50%;background:#fff;box-shadow:0 2px 10px rgba(0,0,0,.35);pointer-events:auto;cursor:ew-resize}
  .mode-fade .slider-rail{display:none} /* ãƒ•ã‚§ãƒ¼ãƒ‰ãŒãƒ¡ã‚¤ãƒ³ */

  /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
  .loading{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.6));z-index:6;opacity:0;visibility:hidden;transition:.2s}
  .loading.show{opacity:1;visibility:visible}
  .spinner{width:36px;height:36px;border:3px solid #ffffff40;border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼ˆå†ç”Ÿä½ç½®ï¼šé’ï¼ãƒãƒƒãƒ•ã‚¡ã‚‚è¡¨ç¤ºï¼‰ */
  .timeline{display:flex;align-items:center;gap:8px;margin:8px 0 2px;font-size:12px}
  .time{min-width:72px;text-align:center;font-variant-numeric:tabular-nums}
  .scrub-wrap{position:relative;flex:1 1 auto}
  .buffer{position:absolute;inset:auto 0 0 0;top:50%;height:6px;transform:translateY(-50%);background:var(--timeline-bg);border:1px solid var(--timeline-border);border-radius:999px;overflow:hidden}
  .buffer>.bar{height:100%;width:0%;background:linear-gradient(90deg,#375a9f,#2b7cff)}
  .scrub{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:transparent;position:relative}
  .scrub::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:#fff;border:1px solid #00000030}
  .scrub::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:#fff;border:1px solid #00000030}

  /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆæ¯”è¼ƒã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã¯ç°ï¼‰ */
  .controls{display:flex;flex-wrap:wrap;gap:8px 10px;align-items:center;padding:10px 2px}
  .controls button,.controls select,.controls input[type="range"]{background:#1b1f2a;color:#e8e8e8;border:1px solid #2a3142;border-radius:8px;padding:8px 10px;font-size:14px}
  .range{flex:1 1 220px;display:flex;align-items:center;gap:8px}
  #range{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:var(--compare-bg);border-radius:999px}
  #range::-webkit-slider-thumb,#range::-moz-range-thumb{width:14px;height:14px;border-radius:50%;background:#fff;border:1px solid #00000030}
</style>
</head>
<body>
  <header class="wrap">
    <h1>éå» Ã— ä»Šï½œYouTube æ¯”è¼ƒï¼ˆãƒ•ã‚§ãƒ¼ãƒ‰ãƒ»åŒæœŸãƒ»ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰</h1>
    <p>ãƒ¡ã‚¤ãƒ³ã¯ãƒ•ã‚§ãƒ¼ãƒ‰æ¯”è¼ƒã€‚å¿…è¦ã«å¿œã˜ã¦ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ã§ä¸­å¤®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼ˆã‚µãƒ–ï¼‰ã‚‚ä½¿ç”¨ã€‚å†ç”Ÿãƒ»ã‚·ãƒ¼ã‚¯ã¯2æœ¬ã‚’åŒæœŸã—ã¾ã™ã€‚</p>
  </header>

  <main class="wrap">
    <section id="compare" class="compare mode-fade" aria-label="YouTubeæ¯”è¼ƒ">
      <!-- ä¸Šéƒ¨ãƒ©ãƒ™ãƒ«ï¼†ãƒŸãƒ‹ãƒ•ã‚§ãƒ¼ãƒ€ãƒ¼ï¼ˆãƒ•ã‚§ãƒ¼ãƒ‰ç”¨ï¼‰ -->
      <div class="topband">
        <div class="tag past"><span class="dot"></span><span>éå»</span><span class="sub" id="stampPast"></span></div>
        <div style="display:flex;align-items:center;gap:8px;">
          <div class="mode-badge" id="modeBadge">ãƒ¢ãƒ¼ãƒ‰ï¼šãƒ•ã‚§ãƒ¼ãƒ‰</div>
          <div class="fade-mini">
            <span>éå»</span>
            <input id="fadeInline" type="range" min="0" max="100" value="100" step="1" aria-label="ãƒ•ã‚§ãƒ¼ãƒ‰ï¼ˆéå»â†”ä»Šï¼‰">
            <span>ä»Š</span>
          </div>
        </div>
        <div class="tag now"><span class="dot"></span><span>ä»Š</span><span class="sub" id="stampNow"></span></div>
      </div>

      <!-- ä¸‹ï¼šéå» -->
      <div class="layer bottom">
        <div id="pastBox" class="ytbox"></div>
      </div>

      <!-- ä¸Šï¼šä»Šï¼ˆãƒ•ã‚§ãƒ¼ãƒ‰å¯¾è±¡ï¼‰ -->
      <div class="layer top" id="topLayer">
        <div id="nowBox" class="ytbox"></div>
      </div>

      <!-- ã‚µãƒ–ï¼šä¸­å¤®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼ˆãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ã§ä½¿ç”¨ï¼‰ -->
      <div class="slider-rail" aria-hidden="true">
        <div class="split-line" id="splitLine"></div>
        <div class="handle" id="handle" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="50" aria-label="æ¯”è¼ƒä½ç½®"></div>
      </div>

      <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
      <div class="loading" id="loading"><div class="spinner"></div></div>
    </section>

    <!-- ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼ˆé’ï¼‰ -->
    <section class="timeline" aria-label="ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³">
      <div class="time" id="timeCur">00:00</div>
      <div class="scrub-wrap">
        <div class="buffer"><div class="bar" id="bufferBar"></div></div>
        <input id="scrub" class="scrub" type="range" min="0" max="1" step="0.0001" value="0" aria-label="å†ç”Ÿä½ç½®">
      </div>
      <div class="time" id="timeDur">--:--</div>
    </section>

    <!-- æ“ä½œç¾¤ -->
    <section class="controls" aria-label="å†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«">
      <button id="playBtn" type="button" title="å†ç”Ÿ/ä¸€æ™‚åœæ­¢ï¼ˆSpaceï¼‰">â–¶ï¸ å†ç”Ÿ</button>
      <button id="restartBtn" type="button">â†º å…ˆé ­</button>
      <button id="muteBtn" type="button">ğŸ”‡ ãƒŸãƒ¥ãƒ¼ãƒˆ</button>
      <select id="speedSel" title="å†ç”Ÿé€Ÿåº¦">
        <option value="0.25">0.25Ã—</option>
        <option value="0.5">0.5Ã—</option>
        <option value="1" selected>1Ã—</option>
        <option value="1.5">1.5Ã—</option>
        <option value="2">2Ã—</option>
      </select>

      <div class="range">
        <span id="rangeLabel">æ¯”è¼ƒä½ç½®ï¼ˆã‚µãƒ–ï¼‰ï¼š</span>
        <input id="range" type="range" min="0" max="100" value="50" step="0.1" aria-label="æ¯”è¼ƒä½ç½®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼">
      </div>

      <button id="modeBtn" type="button" title="ãƒ•ã‚§ãƒ¼ãƒ‰ï¼ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼åˆ‡æ›¿">ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</button>
      <button id="fsBtn" type="button" title="ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³">â›¶ å…¨ç”»é¢</button>
    </section>
  </main>

  <!-- YouTube IFrame Player API ã‚’éåŒæœŸãƒ­ãƒ¼ãƒ‰ -->
  <script>
    // å‹•ç”»IDï¼ˆå·®ã—æ›¿ãˆå¯ï¼‰
    const YT_PAST_ID = 'twUhcvIGlpY';   // æ˜”
    const YT_NOW_ID  = 'FON4lib3hgQ';   // ä»Š

    // UIè¦ç´ 
    const compare   = document.getElementById('compare');
    const handle    = document.getElementById('handle');
    const range     = document.getElementById('range');
    const modeBtn   = document.getElementById('modeBtn');
    const modeBadge = document.getElementById('modeBadge');
    const fadeInline= document.getElementById('fadeInline');
    const loading   = document.getElementById('loading');
    const timeCur   = document.getElementById('timeCur');
    const timeDur   = document.getElementById('timeDur');
    const scrub     = document.getElementById('scrub');
    const bufferBar = document.getElementById('bufferBar');
    const playBtn   = document.getElementById('playBtn');
    const restartBtn= document.getElementById('restartBtn');
    const muteBtn   = document.getElementById('muteBtn');
    const speedSel  = document.getElementById('speedSel');
    const fsBtn     = document.getElementById('fsBtn');

    let mode = 'fade'; // 'fade' | 'slider'
    let split = 50;
    function setSplit(p){ split=Math.max(0,Math.min(100,p)); document.documentElement.style.setProperty('--split', split.toFixed(2)+'%'); handle.setAttribute('aria-valuenow', split.toFixed(1)); range.value=split; }
    function setFade(p){ const v=Math.max(0,Math.min(100,p))/100; document.documentElement.style.setProperty('--fade', v.toFixed(3)); fadeInline.value=Math.round(p); range.value=p; }
    setSplit(50); setFade(100);

    function applyMode(m){
      mode=m;
      compare.classList.toggle('mode-fade',   m==='fade');
      compare.classList.toggle('mode-slider', m==='slider');
      modeBadge.textContent = 'ãƒ¢ãƒ¼ãƒ‰ï¼š' + (m==='fade' ? 'ãƒ•ã‚§ãƒ¼ãƒ‰' : 'ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼');
      document.getElementById('rangeLabel').textContent = m==='fade' ? 'ãƒ•ã‚§ãƒ¼ãƒ‰ï¼ˆã‚µãƒ–ï¼‰ï¼š' : 'æ¯”è¼ƒä½ç½®ï¼ˆã‚µãƒ–ï¼‰ï¼š';
    }
    applyMode('fade');
    modeBtn.addEventListener('click', ()=> applyMode(mode==='fade'?'slider':'fade'));
    fadeInline.addEventListener('input', e=> setFade(parseFloat(e.target.value)));

    // ã‚µãƒ–ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼ˆä¸­å¤®ãƒãƒ¼ï¼‰
    function clientXToPercent(clientX){
      const r=compare.getBoundingClientRect(); return (clientX-r.left)/r.width*100;
    }
    let dragging=false;
    function startDrag(){ dragging=true; document.body.style.cursor='ew-resize'; }
    function moveDrag(e){
      if(!dragging) return;
      const x = (e.touches && e.touches[0]) ? e.touches[0].clientX : e.clientX;
      mode==='slider' ? setSplit(clientXToPercent(x)) : setFade(clientXToPercent(x));
    }
    function endDrag(){ dragging=false; document.body.style.cursor=''; }
    handle.addEventListener('mousedown', startDrag);
    window.addEventListener('mousemove', moveDrag, {passive:true});
    window.addEventListener('mouseup', endDrag);
    handle.addEventListener('touchstart', e=>{e.preventDefault();startDrag();},{passive:false});
    window.addEventListener('touchmove', moveDrag, {passive:false});
    window.addEventListener('touchend', endDrag);
    compare.addEventListener('pointerdown', e=>{
      if(e.target!==handle){ const p=clientXToPercent(e.clientX); mode==='slider'?setSplit(p):setFade(p); }
    });
    range.addEventListener('input', e=>{ const p=parseFloat(e.target.value); mode==='slider'?setSplit(p):setFade(p); });

    // YouTube API ãƒ­ãƒ¼ãƒ‰
    let pastPlayer, nowPlayer;
    let readyPast=false, readyNow=false, syncing=false, rafId=null, tickTimer=null;

    function showLoading(){ loading.classList.add('show'); }
    function hideLoading(){ loading.classList.remove('show'); }

    function formatTime(sec){
      if(!isFinite(sec)) return '--:--';
      const s=Math.max(0,Math.floor(sec)), h=Math.floor(s/3600), m=Math.floor((s%3600)/60), r=s%60;
      return h>0 ? `${h}:${String(m).padStart(2,'0')}:${String(r).padStart(2,'0')}` : `${m}:${String(r).padStart(2,'0')}`;
    }

    function updateDuration(){
      const d=Math.min(pastPlayer?.getDuration()||0, nowPlayer?.getDuration()||0);
      if(d>0){ timeDur.textContent=formatTime(d); scrub.max=d; }
    }
    function updateTimeUI(){
      const t=Math.min(pastPlayer?.getCurrentTime()||0, nowPlayer?.getCurrentTime()||0);
      const d=Math.min(pastPlayer?.getDuration()||0, nowPlayer?.getDuration()||0);
      timeCur.textContent=formatTime(t);
      if(d>0){ scrub.value=t; }
      // ãƒãƒƒãƒ•ã‚¡ï¼ˆèª­ã¿è¾¼ã¿å‰²åˆã¯ nowPlayer ãƒ™ãƒ¼ã‚¹ï¼‰
      const frac = nowPlayer?.getVideoLoadedFraction ? nowPlayer.getVideoLoadedFraction() : 0;
      bufferBar.style.width = Math.max(0, Math.min(100, frac*100)) + '%';
    }

    function seekBoth(t){
      const d=Math.min(pastPlayer?.getDuration()||0, nowPlayer?.getDuration()||0);
      const clamped=Math.max(0, Math.min(d||0, t));
      pastPlayer?.seekTo(clamped, true);
      nowPlayer?.seekTo(clamped, true);
      updateTimeUI();
    }

    // åŒæœŸï¼šå·®ãŒ0.25ç§’è¶…ãªã‚‰è¿½éš
    const SYNC_EPS=0.25;
    function syncTick(){
      if(!readyPast||!readyNow) return;
      const tp=pastPlayer.getCurrentTime(), tn=nowPlayer.getCurrentTime();
      const dp = Math.abs(tp-tn);
      if(pastPlayer.getPlayerState()===1 || nowPlayer.getPlayerState()===1){ // å†ç”Ÿä¸­
        if(dp>SYNC_EPS){
          // ã€Œä»Šã€ã‚’ãƒã‚¹ã‚¿ãƒ¼ã«å¯„ã›ã‚‹ï¼ˆç”¨é€”æ¬¡ç¬¬ã§é€†ã‚‚OKï¼‰
          pastPlayer.seekTo(tn, true);
        }
      }
      updateTimeUI();
      rafId = requestAnimationFrame(syncTick);
    }
    function startSync(){ if(!rafId){ rafId=requestAnimationFrame(syncTick); } if(!tickTimer){ tickTimer=setInterval(updateTimeUI,200); } }
    function stopSync(){ if(rafId){ cancelAnimationFrame(rafId); rafId=null; } if(tickTimer){ clearInterval(tickTimer); tickTimer=null; } }

    // å†ç”Ÿåˆ¶å¾¡
    function playBoth(){
      if(!readyPast||!readyNow) return;
      nowPlayer.playVideo(); pastPlayer.playVideo();
      playBtn.textContent='â¸ ä¸€æ™‚åœæ­¢';
    }
    function pauseBoth(){
      nowPlayer.pauseVideo(); pastPlayer.pauseVideo();
      playBtn.textContent='â–¶ï¸ å†ç”Ÿ';
    }

    playBtn.addEventListener('click', ()=>{
      const s = nowPlayer?.getPlayerState?.();
      (s!==1) ? playBoth() : pauseBoth();
    });
    restartBtn.addEventListener('click', ()=> seekBoth(0));
    muteBtn.addEventListener('click', ()=>{
      const muted = nowPlayer?.isMuted?.();
      if(muted){ nowPlayer.unMute(); pastPlayer.unMute(); muteBtn.textContent='ğŸ”‡ ãƒŸãƒ¥ãƒ¼ãƒˆ'; }
      else{ nowPlayer.mute(); pastPlayer.mute(); muteBtn.textContent='ğŸ”Š ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤'; }
    });
    speedSel.addEventListener('change', ()=>{
      const r=parseFloat(speedSel.value)||1;
      nowPlayer?.setPlaybackRate?.(r);
      pastPlayer?.setPlaybackRate?.(r);
    });
    // ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ãƒ‰ãƒ©ãƒƒã‚°ã‚·ãƒ¼ã‚¯
    let scrubbing=false;
    scrub.addEventListener('input', e=>{ scrubbing=true; seekBoth(parseFloat(e.target.value)); });
    scrub.addEventListener('change', ()=>{ scrubbing=false; });

    // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ï¼ˆã‚³ãƒ³ãƒ†ãƒŠï¼‰
    fsBtn.addEventListener('click', async ()=>{
      if(!document.fullscreenElement){ try{ await compare.requestFullscreen(); }catch(e){} }
      else{ await document.exitFullscreen(); }
    });

    // IFrame API ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŒ¿å…¥
    const tag=document.createElement('script');
    tag.src="https://www.youtube.com/iframe_api"; // å…¬å¼API
    document.head.appendChild(tag);

    // API Ready ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å¿…è¦
    window.onYouTubeIframeAPIReady = function(){
      const playerVars = {
        // é‡è¦: enablejsapi ã¯ API å´ã§è‡ªå‹•ä»˜ä¸ã•ã‚Œã‚‹ã€‚playsinline=1 ã§ãƒ¢ãƒã‚¤ãƒ«ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³å†ç”Ÿ
        playsinline: 1, controls: 0, rel: 0, fs: 0, iv_load_policy: 3, disablekb: 1,
        // modestbranding ã¯ç¾åœ¨ã»ã¼åŠ¹æœãªã—ï¼ˆéæ¨å¥¨æ‰±ã„ï¼‰ã€‚â†’ æœªæŒ‡å®š
        origin: location.origin
      };
      showLoading();
      pastPlayer = new YT.Player('pastBox', {
        videoId: YT_PAST_ID, width:'100%', height:'100%', playerVars,
        events:{
          'onReady': (e)=>{ readyPast=true; e.target.mute(); checkReady(); },
          'onStateChange': onStateChange
        }
      });
      nowPlayer = new YT.Player('nowBox', {
        videoId: YT_NOW_ID, width:'100%', height:'100%', playerVars,
        events:{
          'onReady': (e)=>{ readyNow=true; e.target.mute(); checkReady(); },
          'onStateChange': onStateChange
        }
      });
    };

    function onStateChange(ev){
      const s = ev.data; // -1 æœªé–‹å§‹, 0 çµ‚äº†, 1 å†ç”Ÿ, 2 ä¸€æ™‚åœæ­¢, 3 ãƒãƒƒãƒ•ã‚¡, 5 cued
      if(s===3){ showLoading(); }
      if(s===1||s===2||s===0){ hideLoading(); }
      if(s===0){ pauseBoth(); } // ã©ã¡ã‚‰ã‹ãŒçµ‚ç«¯â†’ä¸¡æ–¹åœæ­¢
    }

    function checkReady(){
      if(readyPast && readyNow){
        hideLoading();
        updateDuration();
        updateTimeUI();
        startSync();
        // åˆæœŸã¯ãƒŸãƒ¥ãƒ¼ãƒˆã‹ã¤åœæ­¢è¡¨ç¤º
        playBtn.textContent='â–¶ï¸ å†ç”Ÿ';
        muteBtn.textContent='ğŸ”Š ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤'; // ãƒœã‚¿ãƒ³è¡¨ç¤ºã¯ãƒˆã‚°ãƒ«å‹•ä½œã«åˆã‚ã›ã‚‹
      }
    }

    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ: Space=å†ç”Ÿ/åœæ­¢
    window.addEventListener('keydown', (e)=>{
      if(['INPUT','TEXTAREA','SELECT','BUTTON'].includes(e.target.tagName)) return;
      if(e.code==='Space'){ e.preventDefault(); const s=nowPlayer?.getPlayerState?.(); (s!==1)?playBoth():pauseBoth(); }
    });

    // ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆå¹´ãªã©ï¼‰â€” ç°¡æ˜“ï¼šIDã¨åŒã˜ã§ç©ºã«ã—ã¦ãŠã or å›ºå®šæ–‡è¨€
    document.getElementById('stampPast').textContent = 'YouTube';
    document.getElementById('stampNow').textContent  = 'YouTube';
  </script>
</body>
</html>
